- name: ensure the jenkins apt repository key is installed
  apt_key:
    url: https://pkg.jenkins.io/debian-stable/jenkins.io.key
    state: present

- name: ensure the jenkins repository is configured
  apt_repository:
    repo: 'deb https://pkg.jenkins.io/debian-stable binary/'
    state: present

- name: install jenkins packages
  apt:
    name: "{{ packages }}"
    state: present
    update_cache: yes
  vars:
    packages:
    - openjdk-8-jdk
    - jenkins

- name: start jenkins service
  systemd:
    name: jenkins
    state: started
    enabled: true
 
- name: waiting 30 secs until jenkins is started...
  wait_for:
    timeout: 30
 
- name: get init password jenkins
  shell: cat /var/lib/jenkins/secrets/initialAdminPassword
  changed_when: false
  register: result
 
- name: print init password jenkins
  debug:
    var: result.stdout